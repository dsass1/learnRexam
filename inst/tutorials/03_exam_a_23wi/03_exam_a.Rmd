---
title: "Exam 3"
tutorial:
  id: "isds_exam3a"
  version: 0.1
  
output:
  ISDSfunctions::tutorial:
    progressive: false
    allow_skip: true
runtime: shiny_prerendered
description: >
  This proficiency exam covers Chapter 9.2 - Chapter 12.
---

```{r setup, include=FALSE}
library(skimr)
library(learnr)
library(tidyverse)
library(ISDSfunctions)
library(gradethis)

gradethis_setup(pass = "submitted",
                fail = "submitted",
                error_checker.message = "submitted",
                fail.hint = FALSE
                )

isds_setup(isds_exam = TRUE)

knitr::opts_chunk$set(echo = FALSE)

survey <- read_rds("data/survey.rds")
# 
# survey <- survey_raw %>%
#   mutate(
#     followers_insta = ifelse(followers_insta == 0, NA,
#                            ifelse(followers_insta > 4000, NA,
#                                   followers_insta)),
#     followers_tiktok = ifelse(followers_tiktok == 0, NA,
#                            ifelse(followers_tiktok > 4000, NA,
#                                   followers_tiktok)),
#     height_inches = ifelse(height_inches < 42, NA,
#                            ifelse(height_inches > 84, NA,
#                                   height_inches)),
#     mother_height = ifelse(mother_height < 42, NA,
#                            ifelse(mother_height > 84, NA,
#                                   mother_height)),
#     father_height = ifelse(father_height < 42, NA,
#                            ifelse(father_height > 84, NA,
#                                   father_height)),
#     salary = ifelse(salary < 300000, salary, NA),
#     gpa_nu = ifelse(gpa_nu > 4, NA, gpa_nu),
#     gpa_hs = ifelse(gpa_hs > 5, NA, gpa_hs),
#     exercise = ifelse(exercise > 2500, NA, exercise),
#     marry = ifelse(marry >60, NA, marry),
#     party_bin = ifelse(party_bin == "0", 0,
#                        ifelse(party_bin == "1-2", "1-4",
#                               ifelse(party_bin == "3-4", "1-4", "5+")))
#     ) %>%
#   select(quarter, gender_ident, school_year, num_party, fav_drink, gpa_hs, gpa_nu,
#          campus_housing, happy,
#          followers_insta,followers_tiktok, brain_type, exercise)

#write_rds(survey, file = "survey.rds")

```


```{r, context = "server"}
lock_server("lock", 
            show_correct = FALSE,
            graded = c("Q-R"), graded_pts = c(2),
            ex = c("App1", "App2", "App3"), 
            ex_pts = c(5, 6, 6),
            manual = c("App1-desc", "App2-desc", "App3-desc"), 
            manual_pts = c(2, 2, 2),
            exclude = "Name")
#reset_server("reset")
```

```{r Name}
# student name
question_text("Name:",
              answer_fn(function(value){
                              if(length(value) >= 1 ) {
                                return(mark_as(TRUE))
                                }
                              return(mark_as(FALSE) )
                              }),
              correct = "submitted",
              incorrect = "submitted",
              allow_retry = FALSE )
```

## Instructions

You have 60 minutes to complete this exam. The exam covers the material learned from Section 9.2 - Chapter 12. You are allowed one page of notes front and back.

Once you are finished:

-   Check Submissions to make sure every question/exercise has been submitted.
-  Click the 'lock exam' button. You will not be able to make any changes once this is clicked. 
-   Once the exam is locked you will be able to click on the 'download exam' button.
-   Submit the completed html to Canvas.


## Concept


```{r Q}
#reading check 2
exam(
   shuffle = TRUE,
#quiz(  
  caption = NULL,
  #Q1
  question_wordbank(
  paste0("Consider the price of a customer's meal at a top rated restaurant in Chicago. It is known that the distribution for all customer's at this restaurant (population) is *left-skewed*. <br> <br> Match the following plots with the MOST APPROPRIATE option.<br>
        a)", htmltools::img(src="images/exam3_sampling1c.png", height = 150, width = 200),
        "&nbsp; b)", htmltools::img(src="images/exam3_sampling1d.png", height = 150, width = 200)," <br>
        c)", htmltools::img(src="images/exam3_sampling1a.png", height = 150, width = 200),
        " &nbsp; d)", htmltools::img(src="images/exam3_sampling1b.png", height = 150, width = 200) ),
  choices = c("the distribution of the population (all customer's meal prices)", 
              "a sampling distribution of 20,000 sample means from random samples with sample size n =4",
              "a sampling distribution of 20,000 sample means from random samples with sample size n = 50",  
              "the plot does not match any of the above scenarios"),
  wordbank = c("Plot a", "Plot b", "Plot c", "Plot d"),
  answer(c("Plot c","Plot d", "Plot a", "Plot b"), 
         correct = TRUE),
  allow_retry = TRUE,
  arrange = "ordered",
  correct = "submitted",
  incorrect = "submitted",
    options = list(multi_part = "plot",
                   label = "Q-R")),
  question_dropdown(
    "Again, condider a top rated restaurant in Chicago and we are interested in the price a customer pays for a meal. Theoretically, say we surveyed 50 customers for the price they paid and calculated the average price, and repeated this process 20,000 times. What does one point/observation on this sampling distribution represent?",
    answer("a single customer's meal price"),
    answer("the average of 50 customer's meal price", correct = TRUE),
    answer("the average of 20,000 customer's meal price"),
    answer("the number of customer's that paid more than the average"),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted",
    options = list(multi_part = "plot")
  ),
  question_dropdown(
  "A random sample of college students were asked how many exclusive relationships they have been in since attending college. The 95% confidence interval was found to be (2.7, 3.7). Which of the following is the correct interpretation of this confidence interval? <br>
  **We are 95% confident that...**",
    answer("a randomly chosen college student has been in 2.7 to 3.7 exclusive relationships."),
    answer("95% of college students have been in 2.7 to 3.7 exclusive relationships"),
    answer("the average number of exclusive relationships that college students have been in is between 2.7 and 3.7", correct = TRUE),
    answer("for students in our sample the average number of exclusive relationships they have been is between 2.7 and 3.7."),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "Suppose we want to estimate $\\pi$, the proportion of students at Northwestern who support legalizing marijuana, so we collect a random sample of 100 students and find that 73 of them say they support legalization. We use this data to compute the following 98% confidence interval for $\\pi$: [0.612, 0.824]. Which one of the following statements is true?",
    answer("Exactly 73% of Northwestern students support legalizing marijuana."),
    answer("There is a 98% chance that $\\pi$ is between 0.612 and 0.824."),
    answer("There is a 2% chance our interval does not contain the population parameter.", correct = TRUE),
    answer("The margin of error of our interval is 2%."),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "When working with the sampling distribution of a sample statistic, which of the choices would *decrease* the margin of error?",
    answer("there is no way to change the margin of error"),
    answer("increase the standard error"),
    answer("increase the confidence level (ex: 90% to 95%)"),
    answer("increase the sample size", correct = TRUE),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "Which of the following is true?" ,
    answer("a p-value is the probability that the null hypothesis is true"),
    answer("a large p-value indicates you observed a large effect"),
    answer("a p-value is the probability that the observed statistic was produced by chance alone"),
    answer("a p-value is the probability that the alternative hypothesis is true"),
    answer("a p-value is the probability of observing an estimate as extreme as our sample estimate if the null hypothesis is true", correct = TRUE),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "Which one of the statements below is FALSE when we increase the sample size from 100 to 800? Assume a two-tailed hypothesis test for the mean and no other alterations.",
    answer("test statistic becomes larger"),
    answer("p-value for a hypothesis test becomes larger", correct = TRUE),
    answer("95% confidence interval becomes narrower"),
    answer("standard error becomes smaller"),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "We are trying to determine if the mean GPA for seniors and the mean GPA for first-year students is the same. We construct the following hypothesis test:
  $$H_0: \\mu_{seniors} - \\mu_{first-years} = 0$$
  $$H_A: \\mu_{seniors} - \\mu_{first-years} \\ne 0$$ 
  with significance level of 0.10. <br>
  As a class we perform repeated sampling where each of the 90 students in the class takes one random sample of 30 seniors and 70 first years to test the hypothesis. <br>
  The registrar tells us the true difference in means is 0." ,
    answer("We expect 30 students to decide that there is no difference"),
    answer("We expect 9 students to decide that there is a non-zero difference", correct = TRUE),
    answer("We expect 70 students to decide that there is a non-zero difference"),
    answer("We expect 90 students to decide that there is no difference"),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "Suppose we want to perform a hypothesis test for cancer. What is the person told and what is the truth for a Type I error?" ,
    answer("the person is told they do not have cancer and the truth is they do not have cancer"),
    answer("the person is told they have cancer and the truth is they do not have cancer", correct = TRUE),
    answer("the person is told they do not have cancer and the truth is they have cancer"),
    answer("the person is told they have cancer and the truth is they have cancer"),
    answer("not enough information provided"),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "A consultant conducts an experiment on the effect of webpage layout on sales for an internet company by randomizing individuals to either a new webpage (treatment) or to the old webpage (control). After the intervention the consultant performs a two-sample t-test on the sales from each group and obtains a p-value of 0.047. Which one of the following is a reasonable interpretation of their results?",
    answer("the decision depends on the significance level they set before conducting the experiment", correct = TRUE),
    answer("the p-value rounds to 0.05, so no decision can be made"),
    answer("since the p-value is less than 0.05 the consultant can reject the null hypothesis."),
    answer("since the p-value is greater than 0.01 the consultant can accept the null hypothesis"),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted"
  ),question_wordbank(
  "True or False?",
    choices = c("In hypothesis testing, a Type II error is more commonly known as a false positive.",
                "You can always perform a two-sided test even if the claim is stated as a one-sided test to avoid missing an effect in the opposite dirction of the claim.", "Controlling for a Type I error is always more important than controlling for a Type II error.", "If you increase alpha, $\\alpha$, by 5%, your Type II error rate will decrease by exactly 5%.", "In repeated sampling, the sampling distribution of a sample proportion is the chi-square distribution."
      ),
    wordbank = c("TRUE", "FALSE"),
    answer(c("FALSE", "TRUE", "FALSE", "FALSE", "FALSE"), correct = TRUE),
    allow_retry = TRUE,
    box = 9,
    correct = "submitted",
    incorrect = "submitted"
  ),
  question_dropdown(
  "A young and ambitious teacher believes at least 90% of her students will study for the final exam. The teacher decides to test this belief using a hypothesis test at the $\\alpha = 0.02$ significance level. What is an appropriate null hypothesis <br> <br>
  a) $\\mu_{study} = 0.9$ <br>
  b) $\\mu_{study} > 0.9$ <br>
  c) $\\pi_{study} = 0.9$ <br>
  d) $\\pi_{study} > 0.9$ <br>
  e) $\\hat{\\pi}_{study} \\le 0.9$ <br>",
    answer("a"),
    answer("b"),
    answer("c", correct = TRUE),
    answer("d"),
    answer("e"),
    allow_retry = TRUE,
    correct = "submitted",
    incorrect = "submitted",
    options = list(multi_part = "ht")
  ),
  question_dropdown(
  paste0("In the question above, the hypothesis test results are as follows.<br>" ,   htmltools::img(src="images/htest_1.png", height = 200, width = 500)," <br> What is the decision at the $\\alpha = 0.02$ significance level?"),
    answer("Reject the null, the teacher is correct that at least 90% of students studied.", correct = TRUE),
    answer("Fail to reject the null, the teacher is correct that at least 90% of students studied."),
    answer("Reject the null, the teacher is incorrect and less than 90% of students studied."),
    answer("Fail to reject the null, the teacher is incorrect and less than 90% of students studied."),
    allow_retry = TRUE,
    random_answer_order = TRUE,
    correct = "submitted",
    incorrect = "submitted",
    options = list(multi_part = "ht")
  )
  
)

```


## Application

The following applications use the `survey` dataset which has been preloaded for you.

This data has been pre-cleaned to remove any impossible observations. Missing values have **not** been removed and may need to be handled.

<br>

**NA values should NOT be included in the total count (`n`) of a proportion because we do not know what category they would fall in and it would skew our proportion.**

<br>

If for some reason you are not able to complete the code to obtain the results it would be wise to still interpret your problem with 'placeholder' values for partial credit.

<br>

### Application 1 (5 points)

Suppose we are interested in examining the average GPA of students who take STAT 202 at Northwestern University. 

Use the `survey` data to construct a 90% confidence interval for the average GPA (`gpa_nu`) of students who take STAT 202 at Northwestern University.

```{r App1, exercise=TRUE}

```


```{r App1-solution, exercise.reveal_solution = FALSE}
t.test(x = survey$gpa_nu, conf.level = 0.98)
```

```{r App1-check}
grade_this_code(
  correct = "Submitted",
  incorrect = "Submitted"
)
```
<br>

Interpret the **confidence interval** in the context of the problem.

```{r "App1-desc"}
question_text("", incorrect = "submitted",
              answer("ManuallyGradedEverythingWrong", 
                     correct = TRUE),
              allow_retry = TRUE,
              rows = 5)
```

### Application 2 (5 points)

Suppose we are interested in examining the proportion of students who take STAT 202 at Northwestern University that are `Not too happy`. 

Use the `survey` data to construct a 98% confidence interval for the proportion of students who take STAT 202 at NU that are `Not too happy`.

```{r App2, exercise=TRUE}

```


```{r App2-solution, exercise.reveal_solution = FALSE}
survey %>% 
  count(happy)
prop.test(x = 791, n = c(791+78), p = 0.90, correct = FALSE)
```

```{r App2-check}
grade_this_code(
  correct = "Submitted",
  incorrect = "Submitted"
)
```
<br>

Interpret the **confidence interval** in the context of the problem.

```{r "App2-desc"}
question_text("", incorrect = "submitted",
              answer("ManuallyGradedEverythingWrong", 
                     correct = TRUE),
              allow_retry = TRUE,
              rows = 5)
```


### Application 3 (7 points)

Is there significant evidence that `Extrovert`s who take STAT 202 at NU have more Instagram followers (`followers_insta`) on average than `Introvert`s who take STAT 202 at NU.

Use the `survey` data to conduct a hypothesis test for the difference in **average Instagram followers** between extroverts and introverts at the $\alpha$ = 0.01 significance level.

$$H_0: \mu_{extrovert} - \mu_{introvert} = 0$$
$$H_A: \mu_{extrovert} - \mu_{introvert} \ne 0$$

```{r App3, exercise = TRUE}

```


```{r App3-solution, exercise.reveal_solution = FALSE}
right <- survey %>% 
  filter(personality == "extrovert")

left <- survey %>% 
  filter(personality == "introvert")

t.test(x = right$salary, y = left$salary, conf.level = 0.9)
```

```{r App3-check}
grade_this_code(
  correct = "Submitted",
  incorrect = "Submitted"
)
```
<br>

State your p-value and interpret your decision in the context of the problem.

```{r "App3-desc"}
question_text("", incorrect = "submitted",
              answer("ManuallyGradedEverythingWrong", 
                     correct = TRUE),
              allow_retry = TRUE,
              rows = 10)
```


## survey Data

You are welcome to open the dataset in Posit Cloud as well if the information provided below is not sufficient for you.

Variables:

- `quarter` -- Identifies in which quarter the student took stat 202
- `gender_ident` -- "Which gender do you identify as (Male, Female). "Other" was removed to protect against the possibility of having their responses identified by other students.""
- `school_year` -- "What year are you in school? (First year, Sophomore, Junior, Senior, Other)"
- `num_party` -- "On average (approx.) how many parties a month do you attend?"
- `fav_drink` -- "What is your alcoholic drink of choice? (beer, don't drink, hard_liquor, wine)"
- `personality` -- "Are you more of an introvert or extrovert? (Introvert, Extrovert)"
- `campus_housing` -- "Where do you live on campus? (North campus, South campus, Neither)"
- `happy` -- "How happy are you? (Very happy, Pretty happy, Not too happy, Don't know)"
- `gpa_hs` -- "What was your high school GPA? If unknown type NA."
- `gpa_nu` -- "What is your current GPA at NU? If unknown type NA."
- `followers_insta` -- "How many followers do you have on Instagram? (approx)?"
- `followers_tiktok` -- "How many followers do you have on TikTok? (approx)?"
- `brain_type` -- "Do you consider yourself more "left" or "right" -brained (left-brain, right-brain)?"
- `exercise` -- "Approximately, how many minutes do you spend exercising per week?"

```{r}
glimpse(survey)
```

```{r}
skim(survey)
```


## Submit

Once you are finished:

-   Click "Check submissions" to make sure all questions and exercises are submitted -- **Un-submitted questions will receive a 0.**
-   Once all questions/exercises are submitted click the 'lock exam' button. Once you click this you will not be able to make any changes to your exam!
-   Once the lock is pressed a `Download Exam` option will become available,
-   Download and **Check your HTML!**
-   Upload the html to Canvas.

```{r}
exam_output_ui(id = "lock")
```
<br>
```{r}
lock_button_ui(id = "lock")
```