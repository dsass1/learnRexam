---
title: "Solution Exam 2"
subtitle: "Version B"
format: 
  html:
    self-contained: true

execute:
  message: false
  warning: false
---

# Exam 2 Version B

```{r}
library(tidyverse)


survey <- read_rds("data/survey.rds") %>%
#survey <- survey %>% 
  mutate(
    followers_insta = ifelse(followers_insta == 0, NA,
                           ifelse(followers_insta > 4000, NA,
                                  followers_insta)),
    followers_tiktok = ifelse(followers_tiktok == 0, NA,
                           ifelse(followers_tiktok > 4000, NA,
                                  followers_tiktok)),
    height_inches = ifelse(height_inches < 42, NA,
                           ifelse(height_inches > 84, NA,
                                  height_inches)),
    mother_height = ifelse(mother_height < 42, NA,
                           ifelse(mother_height > 84, NA,
                                  mother_height)),
    father_height = ifelse(father_height < 42, NA,
                           ifelse(father_height > 84, NA,
                                  father_height)),
    salary = ifelse(salary < 500000, salary, NA)
    ) %>% 
  select(quarter, gender_ident, school_year, num_party, fav_drink, personality, 
          campus_housing, height_inches, mother_height, father_height, 
         followers_insta, followers_tiktok,
         exercise, athlete) %>% 
  mutate(fav_drink = relevel(factor(fav_drink), ref = "beer")) 
```

## Concept

- Q1) Between 0 and 1
- Q2) -0.25
- Q3) under-estimate
- Q4) SC
- Q5) intercept for single marital status
- Q6) offset in slope of age for married marital status
- Q7) b
- Q8) causal conclusions only applicable to our sample
- Q9) cluster sampling
- Q10) e) $\\bar{x}$
- Q11) only our sample
- Q12) There could be a confounding variable such as gender, that explains the difference in weight between beer and wine drinkers.
- Q13) No, the groups are likely homogenous (within each hospital there is a shared characteristic impacting satisfaction level) and stratified sampling would be more appropriate.
- Q14) 3.40 and 3.80
- Q15) pnorm(q = -2.5)
- Q16) 2
- Q17) beer
- Q18) don't drink
- Q19) hard_liquor

## Application 1

**Part 1**
```{r}
survey %>% 
  filter(!is.na(followers_tiktok), !is.na(followers_insta)) %>% 
  select(followers_tiktok, followers_insta) %>% 
  cor()
```
MANY ways to solve this.

-1 cor should not be NA
-1 wrong cor

**Part 2**

```{r}
ggplot(survey, aes(x = followers_insta, y = followers_tiktok)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```


**Part 3**
```{r}
model_followers <- lm(followers_tiktok ~ followers_insta, data = survey)
summary(model_followers)
```

**Part 4**

For every 1 inch increase in Instagram followers, the EXPECTED/PREDICTED number of tiktok followers increases by X.


**Part 5**

```{r}
survey %>% 
  filter(!is.na(followers_tiktok), !is.na(followers_insta)) %>% 
  select(followers_tiktok)%>% 
  mutate(fitted = fitted(model_followers))
```


## Application 2

```{r}
model2 <- lm(height_inches ~ father_height + gender_ident, data = survey)

summary(model2)
```

**Part 2**

```{r}
32.623 + 0.4634*68 +5.828*1
```

## Application 3

```{r}
qnorm(p = 0.1, mean = 500, sd = 100, lower.tail = FALSE)
```


